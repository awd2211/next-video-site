# è§†é¢‘è½¬ç å’Œå¤šåˆ†è¾¨ç‡ç³»ç»Ÿ

> **å®Œæ•´çš„è§†é¢‘è½¬ç è§£å†³æ–¹æ¡ˆ** - æ”¯æŒ2K/4Ké«˜æ¸…ã€å¹¶è¡Œå¤„ç†ã€è¾¹ä¸Šä¼ è¾¹è½¬ç ã€GPUåŠ é€Ÿ

---

## ğŸ“‹ æ¦‚è¿°

VideoSiteçš„è§†é¢‘è½¬ç ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„è§†é¢‘å¤„ç†è§£å†³æ–¹æ¡ˆ,æä¾›ä»ä¸Šä¼ åˆ°æ’­æ”¾çš„å®Œæ•´å·¥ä½œæµã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **å¤šåˆ†è¾¨ç‡æ”¯æŒ**: 360p â†’ 480p â†’ 720p â†’ 1080p â†’ 2K â†’ 4K (6æ¡£)
- âœ… **å¹¶è¡Œè½¬ç **: åŒæ—¶å¤„ç†8-20ä¸ªè§†é¢‘,æ— éœ€æ’é˜Ÿ
- âœ… **è¾¹ä¸Šä¼ è¾¹è½¬ç **: ä¸Šä¼ å®Œæˆç«‹å³å¼€å§‹è½¬ç ,é›¶å»¶è¿Ÿ
- âœ… **GPUåŠ é€Ÿ**: NVIDIA/Intel/AMD GPUæ”¯æŒ,é€Ÿåº¦æå‡10å€
- âœ… **æ™ºèƒ½åˆ†è¾¨ç‡**: æ ¹æ®æºè§†é¢‘è‡ªåŠ¨é€‰æ‹©è½¬ç æ¡£ä½
- âœ… **H.265ç¼–ç **: èŠ‚çœ50%å¸¦å®½å’Œå­˜å‚¨æˆæœ¬
- âœ… **HLSæµåª’ä½“**: è‡ªé€‚åº”ç ç‡,æµç•…æ’­æ”¾
- âœ… **è§†é¢‘é¢„è§ˆ**: é¼ æ ‡æ‚¬åœåŠ¨æ€é¢„è§ˆ(ç±»ä¼¼YouTube/Netflix)

### æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| è§†é¢‘å¤„ç† | FFmpeg 4.4+ | è½¬ç ã€åˆ‡ç‰‡ã€ç¼©ç•¥å›¾ç”Ÿæˆ |
| ä»»åŠ¡é˜Ÿåˆ— | Celery + Redis | å¼‚æ­¥å¹¶å‘å¤„ç† |
| å¯¹è±¡å­˜å‚¨ | MinIO (S3å…¼å®¹) | è§†é¢‘æ–‡ä»¶å­˜å‚¨ |
| æ•°æ®åº“ | PostgreSQL | ä»»åŠ¡çŠ¶æ€è¿½è¸ª |
| æµåª’ä½“ | HLS (HTTP Live Streaming) | è‡ªé€‚åº”ç ç‡æ’­æ”¾ |
| å‰ç«¯æ’­æ”¾å™¨ | Video.js | æ”¯æŒ4K + æ¸…æ™°åº¦åˆ‡æ¢ |

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### 1. [ç³»ç»Ÿæ¶æ„](./architecture.md) â­
å®Œæ•´çš„ç³»ç»Ÿæ¶æ„è®¾è®¡,åŒ…æ‹¬:
- å¹¶è¡Œè½¬ç æ¶æ„å›¾
- è¾¹ä¸Šä¼ è¾¹è½¬ç æµç¨‹
- æ•°æ®æµå’Œæ—¶é—´çº¿ç¤ºä¾‹
- Celeryä»»åŠ¡é˜Ÿåˆ—é…ç½®

### 2. [GPUåŠ é€ŸæŒ‡å—](./gpu-acceleration.md) ğŸš€
GPUç¡¬ä»¶åŠ é€Ÿé…ç½®:
- NVIDIA NVENC (H.264/H.265)
- Intel Quick Sync Video
- AMD VCE
- æ€§èƒ½å¯¹æ¯”å’ŒåŸºå‡†æµ‹è¯•

### 3. [è¾¹ä¸Šä¼ è¾¹è½¬ç ](./upload-workflow.md) âš¡
ç®¡ç†å‘˜ä¸Šä¼ å·¥ä½œæµé›†æˆ:
- ä¸Šä¼ å®Œæˆé’©å­
- Celeryä»»åŠ¡è§¦å‘
- å®æ—¶è¿›åº¦æ¨é€
- ç®¡ç†åå°UIé›†æˆ

### 4. [è§†é¢‘æ‚¬åœé¢„è§ˆ](./hover-preview.md) ğŸ¬
é¼ æ ‡hoveråŠ¨æ€é¢„è§ˆåŠŸèƒ½:
- YouTube/Netflixé£æ ¼é¢„è§ˆ
- é¢„è§ˆè§†é¢‘ç”Ÿæˆ
- Reactç»„ä»¶å®ç°
- æ‡’åŠ è½½ä¼˜åŒ–

### 5. [æ•°æ®åº“è®¾è®¡](./database-schema.md) ğŸ’¾
æ•°æ®åº“è¡¨ç»“æ„:
- `transcoding_tasks` è¡¨(å«15+æ–°å­—æ®µ)
- `videos` è¡¨æ‰©å±•
- ç´¢å¼•å’Œæ€§èƒ½ä¼˜åŒ–

### 6. [FFmpegå‘½ä»¤å‚è€ƒ](./ffmpeg-commands.md) ğŸ› ï¸
å®Œæ•´çš„FFmpegå‘½ä»¤ç¤ºä¾‹:
- 2K/4Kè½¬ç å‘½ä»¤
- HLSåˆ‡ç‰‡ç”Ÿæˆ
- ç¼©ç•¥å›¾å’Œé¢„è§ˆç”Ÿæˆ
- GPUåŠ é€Ÿå‘½ä»¤

### 7. [æˆæœ¬ä¼°ç®—](./cost-estimation.md) ğŸ’°
èµ„æºå’Œæˆæœ¬åˆ†æ:
- 4Kè§†é¢‘å­˜å‚¨æˆæœ¬
- CPU vs GPUè½¬ç æˆæœ¬
- å¸¦å®½æˆæœ¬ä¼°ç®—
- æ¨èæœåŠ¡å™¨é…ç½®

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…FFmpeg (Ubuntu/Debian)
sudo apt-get update
sudo apt-get install -y ffmpeg

# æ£€æŸ¥ç‰ˆæœ¬ (éœ€è¦ >= 4.4)
ffmpeg -version

# æ£€æŸ¥GPUæ”¯æŒ (NVIDIA)
ffmpeg -hwaccels | grep cuda

# å®‰è£…Pythonä¾èµ–
cd backend
pip install celery[redis] flower
```

### 2. å¯åŠ¨Celery Worker

```bash
# å¼€å‘ç¯å¢ƒ (å•worker)
celery -A app.tasks.transcoding worker \
  --concurrency=8 \
  --loglevel=INFO

# ç”Ÿäº§ç¯å¢ƒ (å¤šworker + GPU)
celery -A app.tasks.transcoding multi start \
  worker1 worker2 worker3 \
  --concurrency=12 \
  --loglevel=INFO \
  -Q high_priority,normal,low_priority
```

### 3. ç›‘æ§è½¬ç ä»»åŠ¡

```bash
# å¯åŠ¨Flowerç›‘æ§ç•Œé¢
celery -A app.tasks.transcoding flower --port=5555

# è®¿é—®: http://localhost:5555
```

### 4. æµ‹è¯•è½¬ç 

```bash
# é€šè¿‡ç®¡ç†åå°ä¸Šä¼ è§†é¢‘
# URL: http://localhost:3001/videos/upload

# æˆ–ä½¿ç”¨APIæµ‹è¯•
curl -X POST http://localhost:8000/api/v1/admin/upload/init-multipart \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -F "filename=test.mp4" \
  -F "file_size=1073741824" \
  -F "file_type=video/mp4"
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### è½¬ç é€Ÿåº¦ (1å°æ—¶1080pè§†é¢‘)

| æ–¹æ¡ˆ | ç¡¬ä»¶ | è½¬ç æ—¶é—´ | å¹¶å‘æ•° | æˆæœ¬ |
|------|------|---------|--------|------|
| CPUå•æ ¸ | Intel i5 | ~2å°æ—¶ | 1 | ä½ |
| CPU 8æ ¸ | Intel i7 | ~30åˆ†é’Ÿ | 4 | ä¸­ |
| GPU | NVIDIA RTX 3060 | ~10åˆ†é’Ÿ | 12 | é«˜ |
| GPUé›†ç¾¤ | 3x RTX 3060 | ~3åˆ†é’Ÿ | 36 | å¾ˆé«˜ |

### å­˜å‚¨éœ€æ±‚ (1å°æ—¶è§†é¢‘)

| åˆ†è¾¨ç‡ | ç¼–ç  | ç ç‡ | æ–‡ä»¶å¤§å° | å æ¯” |
|--------|------|------|----------|------|
| 4K | HEVC | 25Mbps | ~11GB | 44% |
| 2K | HEVC | 12Mbps | ~5.4GB | 22% |
| 1080p | H.264 | 5Mbps | ~2.2GB | 9% |
| 720p | H.264 | 2.5Mbps | ~1.1GB | 4% |
| 480p | H.264 | 1Mbps | ~450MB | 2% |
| 360p | H.264 | 600kbps | ~270MB | 1% |
| **æ€»è®¡** | - | - | **~25GB** | **100%** |

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: è½¬ç ä»»åŠ¡ä¸€ç›´pendingä¸å¼€å§‹?**
```bash
# æ£€æŸ¥Celery workeræ˜¯å¦è¿è¡Œ
celery -A app.tasks.transcoding inspect active

# æ£€æŸ¥Redisè¿æ¥
redis-cli ping

# æŸ¥çœ‹workeræ—¥å¿—
tail -f /var/log/celery/worker1.log
```

**Q: FFmpegæŠ¥é”™ "codec not found"?**
```bash
# æ£€æŸ¥ç¼–ç å™¨æ˜¯å¦å¯ç”¨
ffmpeg -codecs | grep -E "h264|hevc"

# é‡æ–°ç¼–è¯‘FFmpeg with NVENCæ”¯æŒ
# å‚è€ƒ: docs/guides/ffmpeg-installation.md
```

**Q: GPUåŠ é€Ÿä¸å·¥ä½œ?**
```bash
# æ£€æŸ¥NVIDIAé©±åŠ¨
nvidia-smi

# æ£€æŸ¥FFmpeg GPUæ”¯æŒ
ffmpeg -hwaccels

# æµ‹è¯•GPUç¼–ç 
ffmpeg -hwaccel cuda -i test.mp4 -c:v h264_nvenc output.mp4
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [å¼€å‘ç¯å¢ƒé…ç½®](../../guides/dev-setup.md)
- [å¿«é€Ÿå¼€å§‹æŒ‡å—](../../guides/quick-start.md)
- [æµ‹è¯•æŒ‡å—](../../guides/testing.md)
- [é¡¹ç›®æ€»ä½“æ¶æ„](../../architecture/overview.md)

---

## ğŸ¤ è´¡çŒ®

å¦‚æœæ‚¨å‘ç°æ–‡æ¡£é”™è¯¯æˆ–æœ‰æ”¹è¿›å»ºè®®,è¯·:

1. æäº¤Issue: https://github.com/your-repo/issues
2. åˆ›å»ºPull Request
3. è”ç³»ç»´æŠ¤è€…

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0.0 (2025-10-09)
- âœ¨ æ–°å¢2Kå’Œ4Kåˆ†è¾¨ç‡æ”¯æŒ
- âœ¨ æ–°å¢å¹¶è¡Œè½¬ç èƒ½åŠ› (8-20å¹¶å‘)
- âœ¨ æ–°å¢è¾¹ä¸Šä¼ è¾¹è½¬ç 
- âœ¨ æ–°å¢GPUåŠ é€Ÿæ”¯æŒ
- âœ¨ æ–°å¢è§†é¢‘æ‚¬åœé¢„è§ˆåŠŸèƒ½
- ğŸ”§ ä¼˜åŒ–H.265ç¼–ç èŠ‚çœ50%å¸¦å®½

### v1.0.0 (2025-09-01)
- ğŸ‰ åˆå§‹ç‰ˆæœ¬
- åŸºç¡€è½¬ç åŠŸèƒ½ (360p-1080p)
- HLSæµåª’ä½“æ”¯æŒ

---

**æ–‡æ¡£ç»´æŠ¤**: Claude AI + å¼€å‘å›¢é˜Ÿ
**æœ€åæ›´æ–°**: 2025-10-09
**ç‰ˆæœ¬**: 2.0.0
