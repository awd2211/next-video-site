# VideoSite - è§†é¢‘æµåª’ä½“å¹³å°

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è§†é¢‘æµåª’ä½“å¹³å°ï¼Œæ”¯æŒå„ä¸ªå›½å®¶çš„ç”µè§†å‰§å’Œç”µå½±ã€‚åŒ…å«ç”¨æˆ·ç«¯å’Œå¼ºå¤§çš„åå°ç®¡ç†ç³»ç»Ÿã€‚

## æŠ€æœ¯æ ˆ

### åç«¯
- **FastAPI** - ç°ä»£åŒ–çš„ Python Web æ¡†æ¶
- **PostgreSQL** - ä¸»æ•°æ®åº“
- **SQLAlchemy** - ORM
- **Redis** - ç¼“å­˜å’Œä¼šè¯ç®¡ç†
- **JWT** - èº«ä»½è®¤è¯
- **MinIO** - å¯¹è±¡å­˜å‚¨
- **Celery** - å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—

### å‰ç«¯ï¼ˆç”¨æˆ·ç«¯ï¼‰
- **React 18** + **TypeScript**
- **Vite** - æ„å»ºå·¥å…·
- **TailwindCSS** - æ ·å¼æ¡†æ¶
- **TanStack Query** - æ•°æ®è·å–å’Œç¼“å­˜
- **Video.js** - ç±»ä¼¼ YouTube çš„è§†é¢‘æ’­æ”¾å™¨
- **React Router** - è·¯ç”±ç®¡ç†

### å‰ç«¯ï¼ˆåå°ç®¡ç†ï¼‰
- **React 18** + **TypeScript**
- **Ant Design** - UI ç»„ä»¶åº“
- **Ant Design Charts** - æ•°æ®å¯è§†åŒ–
- **Vite** - æ„å»ºå·¥å…·

## ğŸ“– å®Œæ•´æŠ€æœ¯æ–‡æ¡£

> **æ–°å¢**: ä¸“ä¸šçš„æŠ€æœ¯æ–‡æ¡£å·²è¿ç§»åˆ° [`docs/`](./docs/) ç›®å½•

**å¿«é€Ÿé“¾æ¥**:
- [ğŸ“š æ–‡æ¡£ç´¢å¼•](./docs/README.md) - æŸ¥çœ‹æ‰€æœ‰æ–‡æ¡£
- [ğŸ¬ è§†é¢‘è½¬ç ç³»ç»Ÿ](./docs/features/video-transcoding/) - 2K/4K + å¹¶è¡Œè½¬ç  + GPUåŠ é€Ÿ
- [ğŸ†• è§†é¢‘æ‚¬åœé¢„è§ˆ](./docs/features/video-transcoding/hover-preview.md) - YouTube/Netflixé£æ ¼é¢„è§ˆ
- [ğŸ› ï¸ å¼€å‘ç¯å¢ƒé…ç½®](./docs/guides/dev-setup.md) - å¿«é€Ÿæ­å»ºå¼€å‘ç¯å¢ƒ
- [ğŸ“Š å¼€å‘è¿›åº¦](./docs/status/progress.md) - å½“å‰95%å®Œæˆåº¦

---

## æ ¸å¿ƒåŠŸèƒ½

### ç”¨æˆ·ç«¯åŠŸèƒ½
- âœ… è§†é¢‘æµè§ˆå’Œæœç´¢ (5ç»´åº¦é«˜çº§æœç´¢)
- âœ… ç±»ä¼¼ YouTube çš„è§†é¢‘æ’­æ”¾å™¨ï¼ˆæ”¯æŒé”®ç›˜å¿«æ·é”®ï¼‰
- âœ… **è§†é¢‘æ‚¬åœé¢„è§ˆ** - ğŸ†• é¼ æ ‡hoverè‡ªåŠ¨æ’­æ”¾é¢„è§ˆ
- âœ… æ™ºèƒ½æ¨èç³»ç»Ÿ (ååŒè¿‡æ»¤ + å†…å®¹è¿‡æ»¤)
- âœ… ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- âœ… è§†é¢‘åˆ†ç±»å’Œæ ‡ç­¾
- âœ… è¯„åˆ†å’Œè¯„è®ºç³»ç»Ÿ
- âœ… æ”¶è—å’Œè§‚çœ‹å†å²
- âœ… å¤šå›½å®¶/åœ°åŒºå†…å®¹æ”¯æŒ
- âœ… å“åº”å¼è®¾è®¡

### åå°ç®¡ç†åŠŸèƒ½
- âœ… æ•°æ®ç»Ÿè®¡çœ‹æ¿
- âœ… è§†é¢‘ç®¡ç†ï¼ˆCRUDã€æ‰¹é‡æ“ä½œï¼‰
- âœ… **è§†é¢‘è½¬ç ç³»ç»Ÿ** - ğŸ†• æ”¯æŒ2K/4K + å¹¶è¡Œè½¬ç  + GPUåŠ é€Ÿ
- âœ… ç”¨æˆ·ç®¡ç†ï¼ˆæŸ¥çœ‹ã€å°ç¦ï¼‰
- âœ… è¯„è®ºå®¡æ ¸
- âœ… å†…å®¹åˆ†ç±»ç®¡ç†
- âœ… æ¼”å‘˜/å¯¼æ¼”ç®¡ç†
- âœ… è¿è¥å·¥å…·ï¼ˆè½®æ’­å›¾ã€æ¨èä½ã€å…¬å‘Šï¼‰
- âœ… æ“ä½œæ—¥å¿—
- âœ… æƒé™ç®¡ç†ï¼ˆRBACï¼‰

## é¡¹ç›®ç»“æ„

```
video/
â”œâ”€â”€ backend/                    # Python åç«¯
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas/           # Pydantic schemas
â”‚   â”‚   â”œâ”€â”€ api/               # ç”¨æˆ·ç«¯ API
â”‚   â”‚   â”œâ”€â”€ admin/             # åå°ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ config.py          # é…ç½®
â”‚   â”‚   â”œâ”€â”€ database.py        # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â””â”€â”€ main.py            # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ .env.example
â”‚
â”œâ”€â”€ frontend/                   # React ç”¨æˆ·ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/        # ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ VideoPlayer/   # è§†é¢‘æ’­æ”¾å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ VideoCard/     # è§†é¢‘å¡ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ Header/        # å¤´éƒ¨
â”‚   â”‚   â”‚   â””â”€â”€ Footer/        # åº•éƒ¨
â”‚   â”‚   â”œâ”€â”€ pages/             # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ services/          # API æœåŠ¡
â”‚   â”‚   â””â”€â”€ types/             # TypeScript ç±»å‹
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ admin-frontend/            # React åå°ç®¡ç†
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ layouts/           # å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ pages/             # é¡µé¢
â”‚   â”‚   â””â”€â”€ services/          # API æœåŠ¡
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ docker-compose.yml         # Docker ç¼–æ’
â””â”€â”€ README.md
```

## å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

1. **å…‹éš†é¡¹ç›®å¹¶è¿›å…¥ç›®å½•**
```bash
cd /home/eric/video
```

2. **åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶**
```bash
cp backend/.env.example backend/.env
# ç¼–è¾‘ backend/.env æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®
```

3. **å¯åŠ¨æ‰€æœ‰æœåŠ¡**
```bash
docker-compose up -d
```

4. **è¿è¡Œæ•°æ®åº“è¿ç§»**
```bash
docker-compose exec backend alembic upgrade head
```

5. **è®¿é—®åº”ç”¨**
- ç”¨æˆ·ç«¯: http://localhost:3000
- åå°ç®¡ç†: http://localhost:3001
- API æ–‡æ¡£: http://localhost:8000/api/docs
- MinIO æ§åˆ¶å°: http://localhost:9001

### æ‰‹åŠ¨å®‰è£…

#### åç«¯è®¾ç½®

1. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
```bash
cd backend
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ– venv\\Scripts\\activate  # Windows
```

2. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

3. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶
```

4. **è®¾ç½®æ•°æ®åº“**
```bash
# ç¡®ä¿ PostgreSQL æ­£åœ¨è¿è¡Œ
alembic upgrade head
```

5. **å¯åŠ¨åç«¯**
```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

#### å‰ç«¯è®¾ç½®ï¼ˆç”¨æˆ·ç«¯ï¼‰

1. **å®‰è£…ä¾èµ–ï¼ˆä½¿ç”¨ pnpmï¼‰**
```bash
cd frontend
pnpm install
```

2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
pnpm run dev
```

è®¿é—®: http://localhost:3000

#### åå°ç®¡ç†å‰ç«¯è®¾ç½®

1. **å®‰è£…ä¾èµ–ï¼ˆä½¿ç”¨ pnpmï¼‰**
```bash
cd admin-frontend
pnpm install
```

2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
pnpm run dev
```

è®¿é—®: http://localhost:3001

## è§†é¢‘æ’­æ”¾å™¨åŠŸèƒ½

æ’­æ”¾å™¨åŸºäº Video.jsï¼Œæä¾›ç±»ä¼¼ YouTube çš„ä½“éªŒï¼š

### é”®ç›˜å¿«æ·é”®
- **ç©ºæ ¼/K** - æ’­æ”¾/æš‚åœ
- **â† â†’** - åé€€/å‰è¿› 5 ç§’
- **â†‘ â†“** - å¢åŠ /å‡å°‘éŸ³é‡
- **F** - å…¨å±
- **M** - é™éŸ³
- **0-9** - è·³è½¬åˆ°è§†é¢‘çš„ç‰¹å®šç™¾åˆ†æ¯”

### æ’­æ”¾å™¨ç‰¹æ€§
- è‡ªé€‚åº”è§†é¢‘è´¨é‡
- æ’­æ”¾é€Ÿåº¦æ§åˆ¶ï¼ˆ0.25x - 2xï¼‰
- ç”»ä¸­ç”»æ¨¡å¼
- å­—å¹•æ”¯æŒ
- è¿›åº¦æ¡é¢„è§ˆ
- éŸ³é‡æ§åˆ¶
- å…¨å±æ¨¡å¼

## æ•°æ®åº“æ¨¡å‹

ä¸»è¦æ•°æ®è¡¨ï¼š
- **users** - ç”¨æˆ·è¡¨
- **admin_users** - ç®¡ç†å‘˜ç”¨æˆ·
- **videos** - è§†é¢‘è¡¨
- **categories** - åˆ†ç±»è¡¨
- **countries** - å›½å®¶/åœ°åŒº
- **actors/directors** - æ¼”å‘˜/å¯¼æ¼”
- **comments** - è¯„è®º
- **ratings** - è¯„åˆ†
- **favorites** - æ”¶è—
- **watch_history** - è§‚çœ‹å†å²
- **roles/permissions** - è§’è‰²æƒé™
- **operation_logs** - æ“ä½œæ—¥å¿—
- **banners** - è½®æ’­å›¾
- **recommendations** - æ¨èä½
- **announcements** - å…¬å‘Š

## API ç«¯ç‚¹

### ç”¨æˆ·ç«¯ API (`/api/v1`)

#### è®¤è¯
- `POST /auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /auth/login` - ç”¨æˆ·ç™»å½•
- `POST /auth/refresh` - åˆ·æ–° token
- `GET /auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

#### è§†é¢‘
- `GET /videos` - è·å–è§†é¢‘åˆ—è¡¨
- `GET /videos/{id}` - è·å–è§†é¢‘è¯¦æƒ…
- `GET /videos/trending` - çƒ­é—¨è§†é¢‘
- `GET /search` - æœç´¢è§†é¢‘

#### åˆ†ç±»
- `GET /categories` - è·å–æ‰€æœ‰åˆ†ç±»

#### ç”¨æˆ·
- `GET /users/me` - è·å–ä¸ªäººä¿¡æ¯
- `PUT /users/me` - æ›´æ–°ä¸ªäººä¿¡æ¯

### åå°ç®¡ç† API (`/api/v1/admin`)

#### è§†é¢‘ç®¡ç†
- `GET /admin/videos` - è·å–æ‰€æœ‰è§†é¢‘
- `POST /admin/videos` - åˆ›å»ºè§†é¢‘
- `GET /admin/videos/{id}` - è·å–è§†é¢‘è¯¦æƒ…
- `PUT /admin/videos/{id}` - æ›´æ–°è§†é¢‘
- `DELETE /admin/videos/{id}` - åˆ é™¤è§†é¢‘
- `PUT /admin/videos/{id}/status` - æ›´æ–°è§†é¢‘çŠ¶æ€

#### ç”¨æˆ·ç®¡ç†
- `GET /admin/users` - è·å–æ‰€æœ‰ç”¨æˆ·
- `PUT /admin/users/{id}/ban` - å°ç¦ç”¨æˆ·

#### è¯„è®ºå®¡æ ¸
- `GET /admin/comments/pending` - å¾…å®¡æ ¸è¯„è®º
- `PUT /admin/comments/{id}/approve` - é€šè¿‡è¯„è®º
- `PUT /admin/comments/{id}/reject` - æ‹’ç»è¯„è®º

#### ç»Ÿè®¡æ•°æ®
- `GET /admin/stats/overview` - æ€»è§ˆç»Ÿè®¡

#### æ—¥å¿—
- `GET /admin/logs/operations` - æ“ä½œæ—¥å¿—

## ç¯å¢ƒå˜é‡è¯´æ˜

å‚è€ƒ `backend/.env.example`:

```env
# Application
APP_NAME=VideoSite
DEBUG=True
SECRET_KEY=your-secret-key
JWT_SECRET_KEY=your-jwt-secret-key

# Database
DATABASE_URL=postgresql+asyncpg://user:pass@localhost:5432/videosite
DATABASE_URL_SYNC=postgresql://user:pass@localhost:5432/videosite

# Redis
REDIS_URL=redis://localhost:6379/0

# MinIO
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin

# Celery
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
```

## éƒ¨ç½²

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®

1. **ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯**
2. **é…ç½® Nginx ä½œä¸ºåå‘ä»£ç†**
3. **å¯ç”¨ HTTPS (Let's Encrypt)**
4. **ä½¿ç”¨ä¸“ä¸šçš„å¯¹è±¡å­˜å‚¨ï¼ˆAWS S3/é˜¿é‡Œäº‘ OSSï¼‰**
5. **é…ç½® CDN åŠ é€Ÿè§†é¢‘åˆ†å‘**
6. **è®¾ç½®æ•°æ®åº“å¤‡ä»½ç­–ç•¥**
7. **å¯ç”¨æ—¥å¿—ç›‘æ§å’Œå‘Šè­¦**

### æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨ Redis ç¼“å­˜çƒ­é—¨æ•°æ®
- è§†é¢‘ä½¿ç”¨ CDN åˆ†å‘
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–å’Œç´¢å¼•
- å¼‚æ­¥ä»»åŠ¡å¤„ç†ï¼ˆè§†é¢‘è½¬ç ã€ç»Ÿè®¡è®¡ç®—ï¼‰
- å‰ç«¯èµ„æºå‹ç¼©å’Œæ‡’åŠ è½½

## å¾…å®ç°åŠŸèƒ½

- [ ] è§†é¢‘è½¬ç å’Œå¤šæ¸…æ™°åº¦æ”¯æŒ
- [ ] Elasticsearch å…¨æ–‡æœç´¢
- [ ] å®æ—¶å¼¹å¹•ç³»ç»Ÿ
- [ ] VIP ä¼šå‘˜ç³»ç»Ÿ
- [ ] æ”¯ä»˜é›†æˆ
- [ ] ç¤¾äº¤åˆ†äº«åŠŸèƒ½
- [ ] ç§»åŠ¨ç«¯ App
- [ ] æ¨èç®—æ³•ä¼˜åŒ–
- [ ] å¤šè¯­è¨€æ”¯æŒï¼ˆi18nï¼‰

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

MIT License

## ä½œè€…

VideoSite Team

---

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
